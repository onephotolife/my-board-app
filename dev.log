
> my-board-app@0.1.0 predev
> npm run kill-port


> my-board-app@0.1.0 kill-port
> lsof -ti:3000 | xargs kill -9 2>/dev/null || echo 'Port 3000 is free'


> my-board-app@0.1.0 dev
> node scripts/smart-dev.js 3000

[36m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m
[36m  スマート開発サーバー v1.0  [0m
[36m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m

[32m✅ ポート 3000 は使用可能です[0m

[34m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m
[32m🚀 Next.js開発サーバーを起動します[0m
[32m   URL: http://localhost:3000[0m
[34m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━[0m

   ▲ Next.js 15.4.5 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://192.168.50.253:3000
   - Environments: .env.local, .env.development
   - Experiments (use with caution):
     · optimizePackageImports

 ✓ Starting...
Creating turbopack project {
  dir: '/Users/yoshitaka.yamagishi/Documents/projects/my-board-app',
  testMode: true
}
 ✓ Compiled middleware in 144ms
 ✓ Ready in 980ms
 ⚠ Webpack is configured while Turbopack is not, which may cause problems.
 ⚠ See instructions if you need to configure Turbopack:
  https://nextjs.org/docs/app/api-reference/next-config-js/turbopack

 ○ Compiling / ...
 ✓ Compiled / in 1855ms
 GET / 200 in 2214ms
 ✓ Compiled /api/profile in 247ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
(node:44163) [MONGOOSE] Warning: Duplicate schema index on {"email":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
 GET /api/profile 401 in 478ms
 ✓ Compiled /profile in 498ms
 GET /profile 200 in 598ms
 ✓ Compiled /favicon.ico in 323ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 456ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /api/auth/session 200 in 644ms
 GET /api/auth/session 200 in 32ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
MongoDB connected successfully
 GET /api/profile 200 in 841ms
 GET /api/profile 200 in 44ms
 GET /profile 200 in 68ms
 GET /api/auth/session 200 in 39ms
 GET /api/auth/session 200 in 41ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 259ms
 GET /api/profile 200 in 72ms
 GET /api/profile 200 in 59ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 244ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
Received profile update: {
  name: 'yamagishi',
  bio: '"zikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukai"'
}
Updated user bio: undefined
 PUT /api/profile 200 in 86ms
 GET /api/auth/csrf 200 in 23ms
[2025-08-13T01:56:54.141Z] MongoDB Connection: 🔄 CONNECTING
Details: {
  "isAtlas": true,
  "environment": "development",
  "uri": "mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boa..."
}
[2025-08-13T01:56:54.159Z] MongoDB Connection: ✅ CONNECTION ESTABLISHED
Details: {
  "database": "boardDB",
  "collections": [
    "auditlogs",
    "posts",
    "ratelimits",
    "users",
    "resendhistories",
    "passwordresets"
  ],
  "models": [
    "User"
  ]
}
 POST /api/auth/session 200 in 69ms
 GET /api/profile 200 in 45ms
 GET /api/profile 200 in 45ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /profile 200 in 69ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 253ms
 GET /api/auth/session 200 in 51ms
 GET /api/auth/session 200 in 38ms
 GET /api/profile 200 in 52ms
 GET /api/profile 200 in 42ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 243ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
Received profile update: {
  name: 'yamagishi',
  bio: '"zikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukaizikosyoukai"'
}
Updated user bio: undefined
 PUT /api/profile 200 in 50ms
 GET /api/auth/csrf 200 in 29ms
 POST /api/auth/session 200 in 44ms
 GET /api/profile 200 in 47ms
 GET /api/profile 200 in 46ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /api/auth/session 200 in 28ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
(node:44163) [MONGOOSE] Warning: Duplicate schema index on {"email":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
 GET /api/auth/session 200 in 143ms
 GET /api/profile 200 in 159ms
 GET /api/profile 200 in 57ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /api/auth/session 200 in 28ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
(node:44163) [MONGOOSE] Warning: Duplicate schema index on {"email":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
 GET /api/auth/session 200 in 121ms
 GET /api/profile 200 in 138ms
 GET /api/profile 200 in 42ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /api/auth/session 200 in 61ms
 GET /api/auth/session 200 in 35ms
 GET /api/profile 200 in 55ms
 GET /api/profile 200 in 47ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /profile 200 in 77ms
 GET /api/auth/session 200 in 79ms
 GET /api/auth/session 200 in 36ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 308ms
 GET /api/profile 200 in 49ms
 GET /api/profile 200 in 57ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 237ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /profile 200 in 58ms
 GET /api/auth/session 200 in 33ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 244ms
 GET /api/auth/session 200 in 41ms
 GET /api/profile 200 in 56ms
 GET /api/profile 200 in 45ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 240ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
Received profile update: {
  name: 'yamagishi',
  bio: '"PUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profile"'
}
Updating with: {
  name: 'yamagishi',
  bio: 'PUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profile'
}
Verification - bio in DB: undefined
Response bio: 
 PUT /api/profile 200 in 71ms
 GET /api/auth/csrf 200 in 27ms
 POST /api/auth/session 200 in 42ms
 GET /api/profile 200 in 45ms
 GET /api/profile 200 in 42ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /profile 200 in 65ms
 GET /api/auth/session 200 in 31ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 244ms
 GET /api/auth/session 200 in 43ms
 GET /api/profile 200 in 60ms
 GET /api/profile 200 in 43ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 246ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
 GET /profile 200 in 61ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 247ms
 GET /api/auth/session 200 in 61ms
 GET /api/auth/session 200 in 32ms
 GET /api/profile 200 in 48ms
 GET /api/profile 200 in 42ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 249ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
Received profile update: {
  name: 'yamagishi',
  bio: '"PUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profile"'
}
Updating with: {
  name: 'yamagishi',
  bio: 'PUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profilePUT /api/profile'
}
Verification - bio in DB: undefined
Response bio: 
 PUT /api/profile 200 in 68ms
 GET /api/auth/csrf 200 in 26ms
 POST /api/auth/session 200 in 44ms
 GET /api/profile 200 in 44ms
 GET /api/profile 200 in 44ms
[MongoDB] ❌ MONGODB_ENV=atlas but MONGODB_URI_PRODUCTION is not configured
[MongoDB] 💡 Please set MONGODB_URI_PRODUCTION in .env.local or .env.production
[MongoDB] 📖 See MONGODB_ATLAS_SETUP.md for instructions
[MongoDB] ⚠️ Falling back to local MongoDB
[MongoDB] 💾 Using remote MongoDB: mongodb+srv://***@cluster0.ej6jq5c.mongodb.net/boardDB?retryWrites=true&w=majority
