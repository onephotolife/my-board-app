
> my-board-app@0.1.0 predev
> npm run kill-port


> my-board-app@0.1.0 kill-port
> lsof -ti:3000 | xargs kill -9 2>/dev/null || echo 'Port 3000 is free'


> my-board-app@0.1.0 dev
> node server.js

> Ready on http://localhost:3000
> Socket.io support enabled
 âœ“ Compiled /middleware in 428ms (255 modules)
 â—‹ Compiling / ...
 âœ“ Compiled / in 8.8s (1776 modules)
 GET / 200 in 9245ms
 GET / 200 in 83ms
 GET / 200 in 52ms
 âœ“ Compiled in 374ms (765 modules)
 âœ“ Compiled in 176ms (765 modules)
 GET / 200 in 46ms
 GET / 200 in 44ms
ğŸ” Middleware: ä¿è­·ã•ã‚ŒãŸãƒ‘ã‚¹: /board
ğŸª [Middleware Debug] ã‚¯ãƒƒã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼: null
ğŸ« Middleware: ãƒˆãƒ¼ã‚¯ãƒ³çŠ¶æ…‹: {
  exists: false,
  id: undefined,
  email: undefined,
  emailVerified: undefined,
  pathname: '/board',
  timestamp: '2025-08-28T00:49:42.983Z'
}
ğŸš« Middleware: æœªèªè¨¼ã®ãŸã‚ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ: http://localhost:3000/auth/signin?callbackUrl=%2Fboard
ğŸª [Middleware Auth Debug] ã‚¯ãƒƒã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼: null
ğŸ” [Middleware] èªè¨¼ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹: {
  pathname: '/auth/signin',
  hasToken: false,
  tokenId: undefined,
  emailVerified: undefined,
  callbackUrl: '/board',
  timestamp: '2025-08-28T00:49:42.995Z'
}
 â—‹ Compiling /auth/signin ...
 âœ“ Compiled /auth/signin in 712ms (1777 modules)
 GET /auth/signin?callbackUrl=%2Fboard 200 in 961ms
 â—‹ Compiling /api/auth/[...nextauth] ...
 âœ“ Compiled /api/auth/[...nextauth] in 1680ms (2091 modules)
 POST /api/performance 201 in 1815ms
 POST /api/performance 201 in 1815ms
 GET /api/csrf 200 in 2184ms
 POST /api/performance 201 in 18ms
 POST /api/performance 201 in 30ms
 POST /api/performance 201 in 24ms
 POST /api/performance 201 in 24ms
[next-auth][warn][DEBUG_ENABLED] 
https://next-auth.js.org/warnings#debug_enabled
 GET /api/auth/session 200 in 2778ms
ğŸ” Middleware: ä¿è­·ã•ã‚ŒãŸãƒ‘ã‚¹: /board
ğŸª [Middleware Debug] ã‚¯ãƒƒã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼: null
ğŸ« Middleware: ãƒˆãƒ¼ã‚¯ãƒ³çŠ¶æ…‹: {
  exists: false,
  id: undefined,
  email: undefined,
  emailVerified: undefined,
  pathname: '/board',
  timestamp: '2025-08-28T00:49:55.970Z'
}
ğŸš« Middleware: æœªèªè¨¼ã®ãŸã‚ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ: http://localhost:3000/auth/signin?callbackUrl=%2Fboard
ğŸª [Middleware Auth Debug] ã‚¯ãƒƒã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼: null
ğŸ” [Middleware] èªè¨¼ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹: {
  pathname: '/auth/signin',
  hasToken: false,
  tokenId: undefined,
  emailVerified: undefined,
  callbackUrl: '/board',
  timestamp: '2025-08-28T00:49:55.982Z'
}
 GET /auth/signin?callbackUrl=%2Fboard 200 in 259ms
 POST /api/performance 201 in 22ms
 POST /api/performance 201 in 42ms
 GET /api/csrf 200 in 29ms
 GET /api/auth/session 200 in 31ms
 POST /api/performance 201 in 20ms
 POST /api/performance 201 in 33ms
 POST /api/performance 201 in 32ms
 POST /api/performance 201 in 21ms
ğŸ” Middleware: ä¿è­·ã•ã‚ŒãŸãƒ‘ã‚¹: /board
ğŸª [Middleware Debug] ã‚¯ãƒƒã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼: null
ğŸ« Middleware: ãƒˆãƒ¼ã‚¯ãƒ³çŠ¶æ…‹: {
  exists: false,
  id: undefined,
  email: undefined,
  emailVerified: undefined,
  pathname: '/board',
  timestamp: '2025-08-28T00:50:01.793Z'
}
ğŸš« Middleware: æœªèªè¨¼ã®ãŸã‚ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ: http://localhost:3000/auth/signin?callbackUrl=%2Fboard
ğŸª [Middleware Auth Debug] ã‚¯ãƒƒã‚­ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼: null
ğŸ” [Middleware] èªè¨¼ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹: {
  pathname: '/auth/signin',
  hasToken: false,
  tokenId: undefined,
  emailVerified: undefined,
  callbackUrl: '/board',
  timestamp: '2025-08-28T00:50:01.801Z'
}
 GET /auth/signin?callbackUrl=%2Fboard 200 in 70ms
 POST /api/performance 201 in 23ms
 POST /api/performance 201 in 31ms
 GET /api/csrf 200 in 28ms
 GET /api/auth/session 200 in 29ms
 POST /api/performance 201 in 18ms
 POST /api/performance 201 in 27ms
 POST /api/performance 201 in 21ms
 POST /api/performance 201 in 21ms
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
 GET /api/auth/session 200 in 22ms
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
 GET /api/auth/session 200 in 13ms
 â—‹ Compiling /api/profile ...
 âœ“ Compiled /api/profile in 828ms (2076 modules)
ğŸ”“ [API Security] ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«èªè¨¼ãƒã‚§ãƒƒã‚¯é–‹å§‹
ğŸ” [API Security] ãƒ¡ãƒ¼ãƒ«ç¢ºèªæ¸ˆã¿ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯é–‹å§‹
[next-auth][warn][DEBUG_ENABLED] 
https://next-auth.js.org/warnings#debug_enabled
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
ğŸ” [API Security] ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹: {
  hasSession: true,
  hasUser: true,
  email: 'one.photolife+111@gmail.com',
  emailVerified: true
}
ğŸ” [API Security] ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹: {
  hasSession: true,
  hasUser: true,
  email: 'one.photolife+111@gmail.com',
  emailVerified: true,
  timestamp: '2025-08-28T00:50:42.186Z'
}
âœ… [API Security] èªè¨¼æˆåŠŸ: one.photolife+111@gmail.com
MongoDB connected successfully
ğŸ” [Batch Follow Status] Request: {
  requestUserId: '68ad36cbfd831a5fbd96b575',
  targetUserIds: [
    '68a818205d927f6b75413c56',
    '68a8176840abde7f4273e6e9',
    '68a817542d683a50b97c20b2',
    '68a816974d583357364d1188',
    '68a81606ad0864284c5021ec'
  ],
  count: 5
}
[CSRF] Token mismatch: {
  cookieTokenSample: '241aa2dffe...',
  headerTokenSample: 'b972655226...',
  path: '/api/follow/status/batch',
  method: 'POST'
}
CSRF token validation failed: /api/follow/status/batch
[AUDIT] CSRF_VIOLATION: {
  ip: '::1',
  userAgent: 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36',
  pathname: '/api/follow/status/batch',
  method: 'POST',
  severity: 'CRITICAL'
}
 GET /api/user/permissions 200 in 984ms
 GET /api/profile 200 in 986ms
âœ… [Batch Follow Status] Response: {
  requestUserId: '68ad36cbfd831a5fbd96b575',
  followingCount: 0,
  followingIds: []
}
 POST /api/follow/status/batch 200 in 988ms
ğŸ”“ [API Security] ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«èªè¨¼ãƒã‚§ãƒƒã‚¯é–‹å§‹
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
ğŸ” [API Security] ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹: {
  hasSession: true,
  hasUser: true,
  email: 'one.photolife+111@gmail.com',
  emailVerified: true
}
ğŸ” [API Security] ãƒ¡ãƒ¼ãƒ«ç¢ºèªæ¸ˆã¿ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯é–‹å§‹
ğŸŒ [Redirect callback v4]: {
  url: 'http://localhost:3000/dashboard',
  baseUrl: 'http://localhost:3000'
}
ğŸ”„ [Server Redirect] same origin URL: http://localhost:3000/dashboard
ğŸ« [JWT v4]: {
  hasUser: false,
  hasToken: true,
  userId: undefined,
  tokenId: '68ad36cbfd831a5fbd96b575'
}
ğŸ“Š [Session v4]: {
  hasSession: true,
  hasToken: true,
  tokenId: '68ad36cbfd831a5fbd96b575',
  emailVerified: true
}
ğŸ” [API Security] ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹: {
  hasSession: true,
  hasUser: true,
  email: 'one.photolife+111@gmail.com',
  emailVerified: true,
  timestamp: '2025-08-28T00:50:42.277Z'
}
âœ… [API Security] èªè¨¼æˆåŠŸ: one.photolife+111@gmail.com
 GET /api/user/permissions 200 in 35ms
 GET /api/profile 200 in 37ms
 âœ“ Compiled /_not-found in 434ms (2077 modules)
 GET /api/sns/users/test-user/follow 404 in 643ms
 âœ“ Compiled /api/users/[userId]/follow in 383ms (2079 modules)
[next-auth][warn][DEBUG_ENABLED] 
https://next-auth.js.org/warnings#debug_enabled
 GET /api/users/test-user/follow 401 in 879ms
[CSRF] Missing tokens: {
  hasCookie: false,
  hasHeader: false,
  hasSession: false,
  cookieTokenSample: 'null',
  headerTokenSample: 'null',
  sessionTokenSample: 'null',
  path: '/api/users/test-user/follow',
  method: 'POST'
}
CSRF token validation failed: /api/users/test-user/follow
[AUDIT] CSRF_VIOLATION: {
  ip: '::1',
  userAgent: null,
  pathname: '/api/users/test-user/follow',
  method: 'POST',
  severity: 'CRITICAL'
}
[CSRF] Missing tokens: {
  hasCookie: false,
  hasHeader: false,
  hasSession: false,
  cookieTokenSample: 'null',
  headerTokenSample: 'null',
  sessionTokenSample: 'null',
  path: '/api/users/test-user/follow',
  method: 'DELETE'
}
CSRF token validation failed: /api/users/test-user/follow
[AUDIT] CSRF_VIOLATION: {
  ip: '::1',
  userAgent: null,
  pathname: '/api/users/test-user/follow',
  method: 'DELETE',
  severity: 'CRITICAL'
}
 âœ“ Compiled in 377ms (770 modules)
 âœ“ Compiled in 182ms (770 modules)
 âœ“ Compiled in 200ms (770 modules)
