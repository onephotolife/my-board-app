# ポート管理ドキュメント

## 📚 概要

このドキュメントは、Next.js開発サーバーのポート管理に関する14人天才会議承認済みのソリューションを説明します。

## 🚀 クイックスタート

### 基本的な使用方法

```bash
# 推奨: スマート起動（ポート3000、競合時は自動処理）
npm run dev

# 安全モード（ポートチェックのみ）
npm run dev:safe

# 自動モード（対話型）
npm run dev:auto

# ポートチェックのみ
npm run dev:check
```

## 🔧 利用可能なコマンド

### 1. `npm run dev` (推奨)

スマート開発サーバー起動スクリプトを使用します。

**特徴:**
- ポート3000の自動チェック
- 使用中の場合、対話的に解決策を提示
- 既存プロセスの安全な停止オプション
- 代替ポートの自動提案

**動作フロー:**
1. ポート3000をチェック
2. 使用可能 → 即座に起動
3. 使用中 → ユーザーに確認
   - 既存プロセスを停止するか
   - 代替ポートを使用するか

### 2. `npm run dev:safe`

従来の安全な起動方法です。

**特徴:**
- ポートチェック後に起動
- エラー時は起動を中止
- 手動での対処が必要

### 3. `npm run dev:auto`

Shell スクリプトベースの自動化ツールです。

**特徴:**
- より詳細な対話型インターフェース
- プロセス情報の表示
- Unix/Linux/macOS専用

### 4. `npm run dev:check`

ポートの状態をチェックするだけのユーティリティです。

**使用例:**
```bash
npm run dev:check
# または特定のポート
node scripts/port-finder.js 3001
```

### 5. `npm run kill-port`

ポート3000を強制的に解放します。

**注意:** このコマンドは既存のプロセスを強制終了します。

```bash
npm run kill-port
```

### 6. `npm run predev`

`npm run dev`実行前に自動的に実行されます。
ポート3000の既存プロセスをクリーンアップします。

## 📁 スクリプトファイル

### `/scripts/smart-dev.js`

メインの開発サーバー管理スクリプト。

**機能:**
- ポート競合の自動検出
- 対話的な問題解決
- クロスプラットフォーム対応
- エラーハンドリング

### `/scripts/port-finder.js`

ポート状態チェックユーティリティ。

**機能:**
- ポート使用状況の確認
- 代替ポートの検索
- Node.js APIベース

### `/scripts/dev-server.sh`

Shellベースの開発サーバー管理スクリプト。

**機能:**
- Unix系OS専用
- 詳細なプロセス情報
- カラフルな出力

## 🛠️ トラブルシューティング

### よくある問題と解決策

#### 1. ポート3000が使用中

**症状:**
```
Error: listen EADDRINUSE: address already in use :::3000
```

**解決策:**
```bash
# オプション1: スマート起動を使用
npm run dev
# → 対話的に解決

# オプション2: 強制的にポートを解放
npm run kill-port
npm run dev

# オプション3: 代替ポートを使用
npx next dev --turbopack --port 3001
```

#### 2. 権限エラー

**症状:**
```
Error: Permission denied
```

**解決策:**
```bash
# スクリプトに実行権限を付与
chmod +x scripts/*.sh
chmod +x scripts/*.js
```

#### 3. スクリプトが見つからない

**症状:**
```
Error: Cannot find module './scripts/smart-dev.js'
```

**解決策:**
```bash
# プロジェクトルートから実行
cd /path/to/my-board-app
npm run dev
```

## 🔍 デバッグ

### ポート使用状況の確認

```bash
# macOS/Linux
lsof -i :3000

# Windows
netstat -ano | findstr :3000
```

### プロセスの確認

```bash
# macOS/Linux
ps aux | grep node

# Windows
tasklist | findstr node
```

## 📊 パフォーマンス

### 起動時間の目安

- 初回起動: 2-3秒
- 2回目以降: 1-2秒
- ポート競合解決: +1-2秒

### メモリ使用量

- 開発サーバー: 約200-400MB
- Turbopack有効時: 約300-500MB

## 🔐 セキュリティ

### ベストプラクティス

1. **本番環境では使用しない**
   - これらのスクリプトは開発環境専用です

2. **ポート番号の管理**
   - デフォルトポート（3000）の変更を検討
   - ファイアウォール設定の確認

3. **プロセス管理**
   - 不要なプロセスは適切に停止
   - 定期的なプロセスチェック

## 📝 変更履歴

### v1.0.0 (2025-08-10)
- 初回リリース
- 14人天才会議による承認
- スマート起動機能の実装
- 自動ポート検出機能
- 対話型問題解決

## 🤝 貢献

問題や改善提案がある場合は、GitHubのIssueまたはPull Requestでお知らせください。

## 📜 ライセンス

このプロジェクトのライセンスに従います。

---

**14人天才会議承認済み** - 2025年8月10日