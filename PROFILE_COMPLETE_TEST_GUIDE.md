# プロフィール機能 完全テストガイド

## 📋 事前準備チェックリスト

### 環境準備
- [ ] MongoDB起動確認: `mongod`
- [ ] 開発サーバー起動: `npm run dev`
- [ ] ブラウザ準備: Chrome/Firefox（開発者ツール使用可）
- [ ] テストユーザー作成済み: `node test-profile-setup.js`

### テストアカウント情報
```
Email: profile.test@example.com
Password: Test1234!
初期名前: テストユーザー
初期自己紹介: これはテスト用のプロフィールです。
```

---

## 🧪 テスト実施手順

### TEST 1: ヘッダーのプロフィールリンク確認

#### 手順
1. ブラウザで `http://localhost:3000` を開く
2. 右上のログインボタンからサインイン
   - Email: `profile.test@example.com`
   - Password: `Test1234!`
3. ログイン後、ヘッダー右側を確認

#### チェックポイント ✓
- [ ] ユーザー名「テストユーザーさん」が表示される
- [ ] アバターアイコンが表示される（円形、頭文字表示）
- [ ] アバターの頭文字が「テ」または「テス」
- [ ] アバターをクリックするとメニューが開く
- [ ] メニューに「プロフィール」と「ログアウト」がある

#### スクリーンショット推奨箇所
- ログイン後のヘッダー全体
- アバターメニュー展開時

---

### TEST 2: プロフィールページ表示確認

#### 手順
1. ヘッダーのアバターアイコンをクリック
2. 「プロフィール」を選択
3. `/profile` ページに遷移

#### チェックポイント ✓
- [ ] ページタイトル「プロフィール」が表示される
- [ ] サブタイトル「アカウント情報の確認と編集」が表示される
- [ ] アバター（大）に頭文字「テ」が表示される
- [ ] 基本情報セクションに以下が表示される：
  - [ ] 名前: テストユーザー
  - [ ] メールアドレス: profile.test@example.com（編集不可）
  - [ ] 自己紹介: これはテスト用のプロフィールです。
- [ ] メールアドレス横に「確認済み」チップが表示される
- [ ] 「編集」ボタンが右上に表示される

#### 確認すべきUIの詳細
```
アバター背景色: 名前に基づいた一貫した色
メールフィールド: グレーアウト状態
編集ボタン: プライマリカラー
```

---

### TEST 3: プロフィール編集機能

#### 手順
1. 「編集」ボタンをクリック
2. 編集モードに切り替わることを確認
3. 以下の内容に変更：
   - 名前: 「更新テストユーザー」
   - 自己紹介: 「プロフィールを更新しました。テスト実行中です。」
4. 「保存」ボタンをクリック

#### チェックポイント ✓
編集モード切り替え時：
- [ ] 「編集」ボタンが「保存」「キャンセル」ボタンに変わる
- [ ] 名前フィールドが編集可能になる
- [ ] 自己紹介フィールドが編集可能になる
- [ ] メールアドレスは編集不可のまま
- [ ] 文字数カウンター「○/50」「○/200」が表示される

保存後：
- [ ] 成功メッセージ「プロフィールを更新しました」が表示される
- [ ] 編集モードが終了する
- [ ] 新しい情報が表示される
- [ ] アバターの頭文字が「更」または「更新」に変わる
- [ ] **ヘッダーの名前が「更新テストユーザーさん」に変わる**

#### エラーハンドリング確認
1. 名前を空にして保存 → エラーメッセージ確認
2. キャンセルボタンクリック → 元の値に戻ることを確認

---

### TEST 4: 文字数制限の検証

#### 手順
1. 再度「編集」ボタンをクリック
2. 各フィールドで文字数制限をテスト

#### テストケース

##### 名前フィールド（50文字制限）
```
入力: あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわをん1234567890
（51文字）
```

##### 自己紹介フィールド（200文字制限）
```
入力: 200文字を超える長い文章...（201文字以上）
```

#### チェックポイント ✓
- [ ] 名前50文字超過時：
  - [ ] エラーメッセージ「名前は50文字以内で入力してください」
  - [ ] 文字数カウンター「51/50」が赤色表示
  - [ ] 保存ボタンが無効化される
- [ ] 自己紹介200文字超過時：
  - [ ] エラーメッセージ「自己紹介は200文字以内で入力してください」
  - [ ] 文字数カウンター「201/200」が赤色表示
  - [ ] プログレスバーが赤色になる
  - [ ] 保存ボタンが無効化される

---

### TEST 5: パスワード変更機能

#### 手順
1. セキュリティセクションの「パスワード変更」ボタンをクリック
2. ダイアログが開くことを確認
3. 以下を入力：
   - 現在のパスワード: `Test1234!`
   - 新しいパスワード: `NewPass1234!`
   - 新しいパスワード（確認）: `NewPass1234!`
4. 「変更する」ボタンをクリック

#### チェックポイント ✓
ダイアログ表示：
- [ ] タイトル「パスワード変更」が表示される
- [ ] 3つのパスワードフィールドが表示される
- [ ] 各フィールドに目のアイコン（表示/非表示切り替え）
- [ ] ヘルプテキスト「8文字以上、大文字・小文字・数字・特殊文字を含む」

バリデーション確認：
- [ ] 短いパスワード入力時にエラー表示
- [ ] 確認パスワード不一致時にエラー表示
- [ ] 現在のパスワードと同じ場合にエラー表示

成功時：
- [ ] 成功メッセージ表示
- [ ] 「セキュリティのため、再度ログインしてください」
- [ ] 2秒後に自動的にサインインページへリダイレクト

---

### TEST 6: データ永続性の確認

#### 手順
1. プロフィール編集後、ページをリロード（F5）
2. ログアウトして再ログイン
3. プロフィールページを再度確認

#### チェックポイント ✓
- [ ] リロード後も編集内容が保持されている
- [ ] 再ログイン後も変更が保持されている
- [ ] ヘッダーの名前表示が一貫している
- [ ] アバターの頭文字が正しく表示される

---

### TEST 7: レスポンシブデザイン確認

#### 手順
1. 開発者ツールを開く（F12）
2. レスポンシブモードに切り替え
3. 各デバイスサイズで確認

#### デバイスサイズ
- [ ] モバイル (375px): iPhone SE
- [ ] タブレット (768px): iPad
- [ ] デスクトップ (1920px): Full HD

#### チェックポイント ✓
- [ ] すべての要素が正しく配置される
- [ ] テキストが切れたり重なったりしない
- [ ] ボタンがタップ可能なサイズ
- [ ] フォームフィールドが適切な幅

---

## 🎯 パフォーマンスチェック

### 測定項目
1. **ページ読み込み時間**
   - プロフィールページ初回表示: 目標 < 1秒
   - データ取得時間: 目標 < 500ms

2. **更新処理**
   - プロフィール保存: 目標 < 2秒
   - パスワード変更: 目標 < 2秒

3. **UI応答性**
   - 文字入力時の遅延: なし
   - バリデーション表示: 即座

### 測定方法
```javascript
// コンソールで実行
console.time('ProfileLoad');
// ページ遷移
console.timeEnd('ProfileLoad');
```

---

## ⚠️ エッジケースのテスト

### 特殊文字の処理
- [ ] 名前に絵文字を含む: 「テスト😀ユーザー」
- [ ] 名前に空白のみ: 「   」→ エラー
- [ ] HTMLタグを含む: `<script>alert('test')</script>` → サニタイズ確認

### ネットワークエラー
1. 開発者ツール → Network → Offline
2. プロフィール更新を試みる
3. エラーメッセージ「プロフィールの更新に失敗しました」確認

### 同時編集
1. 2つのブラウザタブで同じアカウントにログイン
2. 両方でプロフィール編集
3. 最後の更新が反映されることを確認

---

## 📊 テスト結果記録表

| テスト項目 | 結果 | 実施時刻 | 備考 |
|-----------|------|---------|------|
| TEST 1: ヘッダー | ⬜ | | |
| TEST 2: 表示確認 | ⬜ | | |
| TEST 3: 編集機能 | ⬜ | | |
| TEST 4: 文字数制限 | ⬜ | | |
| TEST 5: パスワード | ⬜ | | |
| TEST 6: 永続性 | ⬜ | | |
| TEST 7: レスポンシブ | ⬜ | | |

## 🐛 発見された不具合

| No. | 内容 | 再現手順 | 優先度 | ステータス |
|-----|------|---------|--------|-----------|
| 1 | | | | |

---

## ✅ 最終確認チェックリスト

### 機能要件
- [ ] プロフィール情報の表示
- [ ] アバター頭文字表示
- [ ] 名前・自己紹介の編集
- [ ] 成功メッセージ表示
- [ ] ヘッダー名前更新
- [ ] パスワード変更機能

### 非機能要件
- [ ] レスポンス時間 < 1秒
- [ ] エラーハンドリング完備
- [ ] XSS対策実装
- [ ] アクセシビリティ対応

### ユーザビリティ
- [ ] 直感的な操作性
- [ ] 明確なフィードバック
- [ ] 一貫したデザイン
- [ ] モバイル対応

---

## 📝 メモ欄

テスト実施中の気づきや改善提案を記録：

```
例：
- アバターの色がリロードで変わる？
- 保存ボタンの位置が分かりにくい
- 成功メッセージの表示時間が短い
```

---

実施者: _______________
実施日: _______________
環境: Development / Staging / Production
ブラウザ: _______________
OS: _______________